import{_ as O,a0 as Q,u as W,o as X,r as v,a as Y,h as Z,b as _,c as C,d as t,t as h,a2 as s,w as l,ab as ee,f as I,g as w,a4 as te,E as ae,j as T,i as $,ad as se,a3 as L,ae as oe,a7 as le,p as ne,k as ce}from"./index-6dffac25.js";import{c as ie,E as de}from"./el-select-cf2ef9f1.js";/* empty css                 */import{b as re,a as he}from"./el-table-column-dc9dfa0f.js";import{k as V}from"./challenge-1b18c821.js";import{f as y,o as B}from"./tool-42e08b78.js";import{E as ue}from"./el-loading-4602192f.js";import"./strings-1c75be88.js";import"./isEqual-9c97ee0b.js";import"./_initCloneObject-b01b6320.js";import"./index-a7882466.js";import"./flatten-b23efee2.js";/* empty css                   */const i=m=>(ne("data-v-063f2acf"),m=m(),ce(),m),pe={class:"container"},_e={class:"title mb24"},fe={class:"flex-between mb16"},ge={class:"flex-center"},me=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-Search"})],-1)),ke=i(()=>t("svg",{class:"icon mr8","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-Delete"})],-1)),be={class:"icon mr8","aria-hidden":"true",style:{"font-size":"12px"}},ve=i(()=>t("use",{"xlink:href":"#icon-chuangjian"},null,-1)),Ce=[ve],$e={class:"expand-panel"},ye=i(()=>t("div",{class:"title mb16"},"Challenge Tracks：",-1)),xe={class:"flex"},Te=["onClick"],Se=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-bianji"})],-1)),Ee=[Se],Ne=["onClick"],ze=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-Delete"})],-1)),De=[ze],Ie=["onClick"],we={key:0,class:"round-status success"},Le=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-xuanzhe"})],-1)),Ve=[Le],Be={key:1,class:"round-status error"},je=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-qingchu"})],-1)),Ke=[je],Me={class:"flex"},Ue=["onClick"],Ae=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-bianji"})],-1)),Pe=[Ae],qe=["onClick"],He=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-a-HostedChallenge"})],-1)),Re=[He],Fe=["onClick"],Ge=i(()=>t("svg",{class:"icon","aria-hidden":"true"},[t("use",{"xlink:href":"#icon-Delete"})],-1)),Je=[Ge],Oe={__name:"Index",setup(m){const{t:u}=Q(),k=W(),j=()=>{k.push("/host/challenge/add")};X(()=>{f()});const x=v(""),S=v([]),d=Y({total:0,pageNum:1,pageSize:10}),E=()=>{d.pageNum=1,f()},b=v([]),K=e=>{b.value=e},N=v(),M=()=>{N.value.clearSelection()},f=()=>{const e=ue.service();Z("all","all","all",{page:d.pageNum,title:x.value}).then(o=>{let r=o.results||[];r.forEach(p=>{p.trackList=[],p.loadTracks=!1}),S.value=r,d.total=o.count}).finally(o=>{e.close()})},U=e=>{k.push(`/host/challenge/edit/${e.id}`)},A=e=>{k.push(`/host/track/add/${e.id}`)},P=e=>{B({title:u("host.deleteChallengeTitle"),message:u("host.deleteChallengeNote")}).then(()=>{se(e.id).then(o=>{L.success(u("host.deleteSuccess")),f()})}).catch(()=>{})},q=()=>{},H=(e,o)=>{k.push(`/host/track/edit/${e.id}/${o.id}`)},R=(e,o)=>{B({title:u("host.deleteTrackTitle"),message:u("host.deleteTrackNote")}).then(()=>{oe(e.id,o.id).then(r=>{L.success(u("host.trackDeleteSuccess")),V(e.id).then(p=>{e.trackList=p.results||[],e.loadTracks=!0})})}).catch(()=>{})},F=(e,o)=>{e.loadTracks||V(e.id).then(r=>{e.trackList=r.results||[],e.loadTracks=!0})};return(e,o)=>{const r=te,p=ie,z=ae,c=he,g=le,D=re,G=de;return _(),C("div",pe,[t("div",_e,h(e.$t("host.ChallList")),1),t("div",fe,[t("div",ge,[s(r,{modelValue:x.value,"onUpdate:modelValue":o[0]||(o[0]=a=>x.value=a),placeholder:e.$t("search"),clearable:"",style:{width:"240px"},onKeyup:ee(E,["enter"]),onClear:E},{prefix:l(()=>[me]),_:1},8,["modelValue","placeholder","onKeyup"]),b.value.length>0?(_(),I(p,{key:0,class:"ml16 custom-selected-tag",size:"large",type:"info",closable:"",style:{"border-radius":"3px"},onClose:M},{default:l(()=>[T(" 已选择"+h(b.value.length)+"项 ",1)]),_:1})):w("",!0),b.value.length>0?(_(),I(z,{key:1,type:"danger",class:"ml16",onClick:o[1]||(o[1]=a=>q())},{default:l(()=>[ke,T(" 批量删除 ")]),_:1})):w("",!0)]),s(z,{type:"primary",class:"ml16",onClick:j},{default:l(()=>[(_(),C("svg",be,Ce)),T(" "+h(e.$t("addChall.createChall")),1)]),_:1})]),s(D,{data:S.value,stripe:"",style:{width:"100%"},ref_key:"multipleTableRef",ref:N,"header-cell-class-name":"thBg",onExpandChange:F,"row-key":"id",onSelectionChange:K},{default:l(()=>[s(c,{type:"expand"},{default:l(a=>[t("div",$e,[ye,s(D,{data:a.row.trackList,"show-header":!1},{default:l(()=>[s(c,{label:"Name",prop:"name",width:"250"}),s(c,{label:"Time"},{default:l(({row:n})=>[t("div",null,h($(y)(n.start_date))+" - "+h($(y)(n.end_date)),1)]),_:1}),s(c,{label:e.$t("operate"),width:"100"},{default:l(({row:n})=>[t("div",xe,[s(g,{class:"box-item",effect:"light",content:e.$t("edit"),placement:"top-start"},{default:l(()=>[t("span",{class:"icon-button",onClick:J=>H(a.row,n)},Ee,8,Te)]),_:2},1032,["content"]),s(g,{class:"box-item",effect:"light",content:e.$t("delete"),placement:"top-start"},{default:l(()=>[t("span",{class:"icon-button",onClick:J=>R(a.row,n)},De,8,Ne)]),_:2},1032,["content"])])]),_:2},1032,["label"])]),_:2},1032,["data"])])]),_:1}),s(c,{prop:"id",label:"ID",width:"100"}),s(c,{prop:"title",label:e.$t("host.title")},{default:l(({row:a})=>[t("div",{class:"underline",onClick:n=>e.$router.push(`/host/challenge/${a.id}`)},h(a.title),9,Ie)]),_:1},8,["label"]),s(c,{prop:"start_date",label:e.$t("host.startDate_utc"),formatter:a=>$(y)(a.start_date)},null,8,["label","formatter"]),s(c,{prop:"end_date",label:e.$t("host.endDate_utc"),formatter:a=>$(y)(a.end_date)},null,8,["label","formatter"]),s(c,{prop:"creator",label:e.$t("host.creator"),width:"150"},{default:l(({row:a})=>{var n;return[t("span",null,h((n=a.creator)==null?void 0:n.created_by),1)]}),_:1},8,["label"]),s(c,{prop:"published",label:e.$t("host.publicyAvailable"),width:"150"},{default:l(({row:a})=>[a.published?(_(),C("span",we,Ve)):(_(),C("span",Be,Ke))]),_:1},8,["label"]),s(c,{label:e.$t("operate"),width:"150"},{default:l(({row:a})=>[t("div",Me,[s(g,{class:"box-item",effect:"light",content:e.$t("edit"),placement:"top-start"},{default:l(()=>[t("span",{class:"icon-button",onClick:n=>U(a)},Pe,8,Ue)]),_:2},1032,["content"]),s(g,{class:"box-item",effect:"light",content:e.$t("host.createTracks"),placement:"top-start"},{default:l(()=>[t("span",{class:"icon-button",onClick:n=>A(a)},Re,8,qe)]),_:2},1032,["content"]),s(g,{class:"box-item",effect:"light",content:e.$t("delete"),placement:"top-start"},{default:l(()=>[t("span",{class:"icon-button",onClick:n=>P(a)},Je,8,Fe)]),_:2},1032,["content"])])]),_:1},8,["label"])]),_:1},8,["data"]),s(G,{"hide-on-single-page":"",background:"",layout:"prev, pager, next",total:d.total,"page-size":d.pageSize,"onUpdate:pageSize":o[2]||(o[2]=a=>d.pageSize=a),"current-page":d.pageNum,"onUpdate:currentPage":o[3]||(o[3]=a=>d.pageNum=a),onSizeChange:f,onCurrentChange:f,class:"mt24 oa-pagination"},null,8,["total","page-size","current-page"])])}}},it=O(Oe,[["__scopeId","data-v-063f2acf"]]);export{it as default};
